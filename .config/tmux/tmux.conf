# Provides true colour support inside tmux
set-option -g default-terminal "tmux-256color"
set-option -ag terminal-features ",alacritty*:RGB"

# Set Ctrl+s as prefix instead of Ctrl+b
# All keybinds imply this prefix
# Note: Ctrl+s by default pauses terminal output on bash/zsh, which can be toggled off with Ctrl+q.
# Either change this prefix or disable this keybind on bash (`stty -xion`) or zsh (`unsetopt flow_control`)
unbind-key C-b
set-option -g prefix C-s
bind-key C-s send-prefix

# [hjkl] to move between panes
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# | for left-right split, - for top-bottom split
bind-key | split-window -h
bind-key - split-window -v

# Enter to make new window
bind-key Enter new-window

# Ctrl+u to automatically enter copy mode and scroll up
bind-key C-u copy-mode -u

# Index starts from 1 instead of 0
set-option -g base-index 1
set-option -g pane-base-index 1

# Colour the panes
set-option -g pane-border-style "fg=brightblack"
set-option -g pane-active-border-style "fg=yellow"

# Set history limit to 10000 lines
# set-option -g history-limit 10000

# Position tmux status bar at the top
set-option -g status-position top

# Set default background/foreground colour as the terminal's
set-option -g status-style "bg=terminal,fg=terminal"

# Set status update interval
set-option -g status-interval 5

# Set window title when tmux is running
set-option -g set-titles on
set-option -g set-titles-string "tmux (#{session_name}): #{pane_title}"

# Change formatting for first status line to enable custom window status formats for activity (@window-status-activity-format) and bell alerts (@window-status-bell-format)
set-option -g status-format[0] "#[align=left range=left #{E:status-left-style}]#[push-default]#{T;=/#{status-left-length}:status-left}#[pop-default]#[norange default]"
set-option -ag status-format[0] "#[list=on align=#{status-justify}]#[list=left-marker]<#[list=right-marker]>#[list=on]#{W:#[range=window|#{window_index} #{E:window-status-style}]"
set-option -ag status-format[0] "#{?window_bell_flag,#{?#{!=:#{E:window-status-bell-style},default},#[#{E:window-status-bell-style}],}#[push-default]#{?@window-status-bell-format,#{T:@window-status-bell-format},#{T:window-status-format}},"
set-option -ag status-format[0] "#{?#{||:#{window_activity_flag},#{window_silence_flag}},#{?#{!=:#{E:window-status-activity-style},default},#[#{E:window-status-activity-style}],}#[push-default]#{?@window-status-activity-format,#{T:@window-status-activity-format},#{T:window-status-format}},"
set-option -ag status-format[0] "#{?window_last_flag,#{?#{!=:#{E:window-status-last-style},default},#[#{E:window-status-last-style}],}#[push-default]#{?@window-status-last-format,#{T:@window-status-last-format},#{T:window-status-format}},"
set-option -ag status-format[0] "#[push-default]#{T:window-status-format}}}}#[pop-default]"
set-option -ag status-format[0] "#[norange default]#{?window_end_flag,,#{window-status-separator}},"
set-option -ag status-format[0] "#[range=window|#{window_index} list=focus #{?#{!=:#{E:window-status-current-style},default},#{E:window-status-current-style},#{E:window-status-style}}]"
# The lines below are commented because current flag overrides all other flags (bell, activity etc)
# set-option -ag status-format[0] "#{?window_bell_flag,#{?#{!=:#{E:window-status-bell-style},default},#[#{E:window-status-bell-style}],}#[push-default]#{?@window-status-bell-format,#{T:@window-status-bell-format},#{T:window-status-current-format}},"
# set-option -ag status-format[0] "#{?#{||:#{window_activity_flag},#{window_silence_flag}},#{?#{!=:#{E:window-status-activity-style},default},#[#{E:window-status-activity-style}],}#[push-default]#{?@window-status-activity-format,#{T:@window-status-activity-format},#{T:window-status-current-format}},"
# set-option -ag status-format[0] "#{?window_last_flag,#{?#{!=:#{E:window-status-last-style},default},#[#{E:window-status-last-style}],}#[push-default]#{?@window-status-last-format,#{T:@window-status-last-format},#{T:window-status-current-format}},"
# set-option -ag status-format[0] "#[push-default]#{T:window-status-current-format}}}}#[pop-default]"
set-option -ag status-format[0] "#[push-default]#{T:window-status-current-format}#[pop-default]"
set-option -ag status-format[0] "#[norange list=on default]#{?window_end_flag,,#{window-status-separator}}}"
set-option -ag status-format[0] "#[nolist align=right range=right #{E:status-right-style}]#[push-default]#{T;=/#{status-right-length}:status-right}#[pop-default]#[norange default]"

ALTBG="#3c3836"

# Note: "default" colour inherits from a parent option. Use "terminal" for "true" terminal default. See tmux/tmux@fc41bf4
set-option -g status-left "#[bg=green,fg=black,bold] #{l:Session} #[bg=${ALTBG},fg=default,nobold] #S #[bg=default] "
set-option -g status-left-length 50

set-option -g window-status-style "fg=brightblack"
set-option -g window-status-activity-style "fg=terminal" # default value is "reverse"
set-option -g window-status-bell-style "default" # default value is "reverse"
set-option -g @window-status-bell-format "#[fg=yellow#,blink][#[noblink]#I:#W#[blink]]#[noblink]"
set-option -g window-status-format " #I:#W "
set-option -g window-status-current-format "#[reverse#,fg=yellow#,bold] #I #[noreverse#,bg=${ALTBG}#,nobold] #W "

# Alternative style (comment out the window status formats above when applying)
# set-option -g window-status-style "reverse,fg=brightblack,bold"
# set-option -g window-status-activity-style "reverse,fg=default,bold"
# set-option -g window-status-bell-style "reverse,fg=red,bold"
# set-option -g window-status-current-style "reverse,fg=yellow,bold"
# set-option -g window-status-format " #I #[noreverse#,bg=${ALTBG},nobold] #W "
# set-option -g window-status-current-format "#{T:window-status-format}"

# set-option -g status-right " #[bg=${ALTBG}#,fg=terminal] #{=/-75/...:pane_title} #[default] "
set-option -g status-right " #[bg=${ALTBG}] #[fg=yellow]%H#[fg=brightblack]:#[fg=terminal]%M#[fg=brightblack]:%S "
# set-option -g status-right-length 100

# Give line gap between tmux status bar and buffer
set-option -g status-format[1] ""
set-option -g status 2
